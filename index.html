<!DOCTYPE html>
<html>
<head>
<title>Get Pre-approved!</title>
</head>

<meta charset="UTF-8">


<body>
	<!-- Include Bootstrap for styling-->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
	
	<!-- Include React -->
	<script src="https://unpkg.com/react@17/umd/react.development.js" crossorigin></script>
	<script src="https://unpkg.com/react-dom@17/umd/react-dom.development.js" crossorigin></script>
	 <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
	
	<!-- include css --> 
	<link rel="stylesheet" href="css/index.css"> 
	
	<!-- <h3 class="mb-3 text-center">Pre-approval form</h1>  !-->

	<!--<div id="investmentAmount_component"></div>
	<script src="js/investmentAmount.js"></script> -->

	<div class="content"> 
		<nav class="site-header sticky-top py-1 navbar navbar-inverse text-center">

		</nav>
		<table class="wide_table">
			<tbody>
				<tr>
					<td class="tdwidth1 m-e-4">
						<p class="largetext">Get Pre-approved!</p>
						<p class="smalltext">Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
					</td>
					<td>
						<div class="card main-card border-primary shadow-lg rounded float-right w-30">
							<div id="form_card_body" class="card-body">
							</div>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
	</div><!--src="js/index.js" -->
	<script type="text/babel"> 
	
	
class PreApprovalForm extends React.Component {
	constructor(props) {
		super(props);
		this.state = {
		  investment_amount: null,
		  investment_type: '',
		  total_net_worth:null,
		  estimated_yearly_income: null,
		  estimated_credit_score: null,
		  err_general:0,
		  err_investment_amount: '',
		  err_investment_type:'',
		  err_total_net_worth:'',
		  err_estimated_yearly_income:'',
		  err_estimated_credit_score:''
		};
	  }
	  
     
   //This function will return A when approved and D when denied
	  mock_fetch(url,params){
	  	var myBlob = new Blob();



		  var status='A';
		 return new Promise(function(resolve,reject){
		    setTimeout(function(){
		      resolve({'status' : status});
		    },20)
		  });
        
        
	  }
	  
	  
	  investmentApprovalAPI(data) {
  	   //mock_fetch simulates a fetch()
  		return this.mock_fetch('api/mock_url', data)
          .then(function (response) {
              });
		}
	  
	  
	  handleChange= (event) =>{
		let ename = event.target.name;
		let evalue = event.target.value;
		this.setState({[ename]: evalue});
	  }
	  
	  validateSubmit= (event) => {	
		event.preventDefault();
		this.state.err_general=0;
		
		//Create regex for alphanumeric tests
		var alphanumeric_match= /^[0-9a-zA-Z]+$/;
		
		//validate Investment Amount field
		if(!Number(this.state.investment_amount)){
			this.state.err_general=1;
			this.setState({["err_investment_amount"]:"This field can only contain numbers"});
		}else{
			this.setState({["err_investment_amount"]:""});
		}
		
		//validate Investment Type field
		if(!alphanumeric_match.test(this.state.investment_type)){
			this.state.err_general=1;
			this.setState({["err_investment_type"]:"This field can only contain alphanumeric characters (A-Z, 0-9)"});
			console.log("VS: "+this.state.investment_type);
		}else{
			this.setState({["err_investment_type"]:""});
		}
		
		
		//validate Total Net Worth field
		if(!Number(this.state.total_net_worth)){
			this.state.err_general=1;
			this.setState({["err_total_net_worth"]:"This field can only contain numbers"});
		}else{
			this.setState({["err_total_net_worth"]:""});
		}
		
		//validate User Estimated Yearly Income
		if(!Number(this.state.estimated_yearly_income)){
			this.state.err_general=1;
			this.setState({["err_estimated_yearly_income"]:"This field can only contain numbers"});
		}else{
			this.setState({["err_estimated_yearly_income"]:""});
		}
		
		//Validate Credit Score
		if(!Number(this.state.estimated_credit_score)){
			this.state.err_general=1;
			this.setState({["err_estimated_credit_score"]:"This field can only contain numbers"});
		}else{
			if(this.state.estimated_credit_score<300 || this.state.estimated_credit_score>850){
				this.state.err_general=1;
				this.setState({["err_estimated_credit_score"]:"Enter a valid credit score between 300 and 850"});
			}else{
				this.setState({["err_estimated_credit_score"]:""});
			}
		}
		
		if(this.state.err_general<1){
        this.investmentApprovalAPI(this.state);
		}
		
		
	  }
	  render() {
	  	return(
			<form onSubmit={this.validateSubmit} class="col-lg-8 offset-lg-3 ">
				{this.state.err_general > 0 ? (
					<div class="alert alert-danger" role="alert">Please correct the errors below</div>
					): null }
					
				<div class="form-group row">
					<label class="col-sm-6 col-form-label required_label" for="investmentAmount">Investment Amount </label>
					<div class="col-sm-9">
						<input type="text" class="form-control is-invalid" id="investmentAmount" name="investment_amount" onChange={this.handleChange} placeholder="Ex: 25000" required />
						<div class="text-danger"><small>{this.state.err_investment_amount}</small></div>
					</div>
				</div>
				<div class="form-group row">
					<label class="col-sm-6 col-form-label required_label" for="investmentType">Investment Type </label>
					<div class="col-sm-9">
						<input type="text" class="form-control" id="investmentType" name="investment_type" onChange={this.handleChange} placeholder="Investment Type" required/>
						<div class="text-danger"><small>{this.state.err_investment_type}</small></div>
					</div>
				</div>
				<div class="form-group row">
					<label class="col-sm-6 col-form-label required_label" for="totalNetWorth">Total Net Worth </label>
					<div class="col-sm-9">
						<input type="text" class="form-control" id="totalNetWorth" name="total_net_worth" onChange={this.handleChange} placeholder="Ex: 1000000" required />
						<div class="text-danger"><small>{this.state.err_total_net_worth}</small></div>
					</div>
				</div>
				<div class="form-group row">
					<label class="col-sm-6 col-form-label required_label" for="estimatedYearlyIncome">User Estimated Yearly Income </label>
					<div class="col-sm-9">
						<input type="text" class="form-control" id="estimatedYearlyIncome" name="estimated_yearly_income" onChange={this.handleChange} placeholder="Ex: 1000000" required />
						<div class="text-danger"><small>{this.state.err_estimated_yearly_income}</small></div>
					</div>
				</div>
				<div class="form-group row">
					<label class="col-sm-6 col-form-label required_label" for="estimatedCreditScore">User Estimated Credit Score </label>
					<div class="col-sm-9">
						<input type="text" class="form-control" id="estimatedCreditScore" name="estimated_credit_score" onChange={this.handleChange} placeholder="Ex: 1000000" required />
						<div class="text-danger"><small>{this.state.err_estimated_credit_score}</small></div>
					</div>
				</div>
				<div class="form-group row">
					<div class="col-sm-9">
					<button type="submit" class="btn btn-primary">Submit</button>
					</div>
				</div>
			</form>
			);
		}
	}

	ReactDOM.render(<PreApprovalForm />, document.getElementById('form_card_body'));
	</script>
</body>
</html>